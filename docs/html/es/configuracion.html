<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>nhopkg — 2. Configuración</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      line-height: 1.6;
      max-width: 900px;
      margin: 2rem auto;
      padding: 0 1rem;
      color: #333;
    }
    h1, h2, h3 {
      color: #2c3e50;
    }
    code {
      background: #f4f4f4;
      padding: 0.2em 0.4em;
      border-radius: 3px;
    }
    pre {
      background: #f9f9f9;
      padding: 1em;
      border-left: 4px solid #ccc;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
    }
    th, td {
      text-align: left;
      padding: 0.5em;
      border-bottom: 1px solid #ddd;
    }
    th {
      background-color: #f0f0f0;
    }
    nav a {
      text-decoration: none;
      color: #2980b9;
    }
    nav a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

  <nav><a href="index.html">← Índice</a></nav>

  <h1>2. Configuración</h1>

  <p>El archivo de configuración principal de <strong>nhopkg</strong> es:</p>
  <pre><code>/etc/nhopkg/nhopkg.conf</code></pre>

  <p>Si no existe, se carga una configuración por defecto desde:</p>
  <pre><code>/usr/share/nhopkg/nhopkg.conf</code></pre>

  <p>Todas las variables definidas en este archivo pueden ser anuladas temporalmente mediante opciones de línea de comandos.</p>

  <h2>Variables principales</h2>

  <h3>Rutas y directorios</h3>
  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Valor por defecto</th>
        <th>Descripción</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>NHOPKG_LOCALSTATEDIR</code></td>
        <td><code>/var/nhopkg</code></td>
        <td>Directorio base para metadatos, caché y logs.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_BUILDIR</code></td>
        <td><code>/usr/src/nhopkg</code></td>
        <td>Directorio donde se compilan los paquetes fuente.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_LOCKFILE</code></td>
        <td><code>/var/lock/nhopkg</code></td>
        <td>Archivo de bloqueo para evitar ejecuciones concurrentes.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_DB</code></td>
        <td><code>/var/nhopkg/nhopkg.db</code></td>
        <td>Base de datos local usada por <code>locate</code> para resolver dependencias por archivo.</td>
      </tr>
    </tbody>
  </table>

  <h3>Opciones generales</h3>
  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Valores</th>
        <th>Descripción</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>NHOPKG_CHECKDEPS</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Verifica dependencias antes de instalar (por defecto: <code>yes</code>).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_CHECKSHA256</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Verifica el checksum SHA256 de los paquetes (por defecto: <code>yes</code>).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_CHECKARCH</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Verifica que la arquitectura del paquete coincida con el sistema (por defecto: <code>yes</code>).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_PURGE</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Al desinstalar, elimina también paquetes que dependen del objetivo (por defecto: <code>no</code>).</td>
      </tr>
      <tr>
        <td><code>VERBOSE_MODE</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Modo verboso durante compilación e instalación (por defecto: <code>no</code>).</td>
      </tr>
      <tr>
        <td><code>STRIP_BINARIES</code></td>
        <td><code>yes</code> / <code>no</code></td>
        <td>Elimina símbolos de depuración de binarios al empaquetar (experimental, por defecto: <code>no</code>).</td>
      </tr>
    </tbody>
  </table>

  <h3>Firmas GPG</h3>
  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Valor por defecto</th>
        <th>Descripción</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>NHOPKG_TRUSTED_KEYS_DIR</code></td>
        <td><code>/etc/nhopkg/trusted-keys/</code></td>
        <td>Directorio del keyring de confianza para verificación de firmas.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_SIGN_PACKAGES</code></td>
        <td><code>yes</code></td>
        <td>Firma los paquetes binarios al construirlos (solo para mantenedores).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_SIGN_KEY</code></td>
        <td><code>repo@neonatox.vegnux.com</code></td>
        <td>Clave GPG predeterminada para firmar paquetes.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_VERIFY_SIGNATURE</code></td>
        <td><code>yes</code></td>
        <td>Verifica la firma GPG de los paquetes antes de instalarlos.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_REQUIRE_SIGNATURE</code></td>
        <td><code>no</code></td>
        <td>Exige que todos los paquetes estén firmados (requiere <code>NHOPKG_VERIFY_SIGNATURE=yes</code>).</td>
      </tr>
    </tbody>
  </table>

  <h3>Repositorios</h3>
  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Ejemplo</th>
        <th>Descripción</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>NHOPKG_ACTIVE_REPOS</code></td>
        <td><code>extra multilib</code></td>
        <td>Lista de repositorios activos (separados por espacios).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_REPO_EXTRA</code></td>
        <td><code>https://neonatox.vegnux.com/repo/n2026/x86_64/extra</code></td>
        <td>URL(s) del repositorio <code>extra</code> (admite múltiples mirrors separados por espacios).</td>
      </tr>
      <tr>
        <td><code>NHOPKG_REPO_MULTILIB</code></td>
        <td><code>https://neonatox.vegnux.com/repo/n2026/x86_64/multilib</code></td>
        <td>URL(s) del repositorio <code>multilib</code>.</td>
      </tr>
      <tr>
        <td><code>NHOPKG_GIT_SOURCES</code></td>
        <td><code>https://gitlab.com/neonatox-sources</code></td>
        <td>URL base para clonar repositorios Git al usar <code>--super-build</code>.</td>
      </tr>
    </tbody>
  </table>

  <h3>Construcción de paquetes</h3>
  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Valor por defecto</th>
        <th>Descripción</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>FIND_DIRS</code></td>
        <td><code>/bin /boot /etc /lib /opt /sbin /srv /usr</code></td>
        <td>Directorios donde <code>nhopkg</code> busca archivos instalados al generar paquetes binarios.</td>
      </tr>
      <tr>
        <td><code>NOUPGRADE_FILES</code></td>
        <td><code>/etc/ld.so.cache mimeinfo.cache info/dir ...</code></td>
        <td>Archivos que se excluyen del paquete binario generado (archivos generados en tiempo de ejecución).</td>
      </tr>
      <tr>
        <td><code>NO_DIRS_IN_DB</code></td>
        <td><code>/dev /home /media /mnt /proc /run /sys /tmp ...</code></td>
        <td>Directorios excluidos de la base de datos local (<code>updatedb</code>).</td>
      </tr>
    </tbody>
  </table>

  <h2>Prioridad de configuración</h2>
  <p>Los valores se aplican en este orden (el último tiene mayor prioridad):</p>
  <ol>
    <li>Archivo de configuración: <code>/etc/nhopkg/nhopkg.conf</code></li>
    <li>Opciones de línea de comandos (ej. <code>--no-check-deps</code>)</li>
  </ol>

  <h2>Ejemplo mínimo</h2>
  <pre><code># Repositorios activos
NHOPKG_ACTIVE_REPOS="extra"

# URL del repositorio
NHOPKG_REPO_EXTRA="https://mi-repo.example.com/nhopkg/x86_64/extra"

# Desactivar verificación de firmas (solo para desarrollo)
NHOPKG_VERIFY_SIGNATURE=no
</code></pre>

</body>
</html>
